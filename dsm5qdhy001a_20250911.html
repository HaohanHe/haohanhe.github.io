<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSM-5 水平1 症状自评量表 - 成人版</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Microsoft YaHei", Arial, sans-serif; }
        body { padding: 15px; line-height: 1.8; background: #f5f7fa; padding-top: 60px; }
        
        /* 导航栏样式 */
        .navbar {
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 0;
            transition: background-color 0.5s;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        .navbar ul {
            list-style: none;
            text-align: center;
            padding: 0;
            margin: 0;
        }
        .navbar ul li {
            display: inline;
            margin: 0 20px;
        }
        .navbar ul li a {
            text-decoration: none;
            color: white;
            font-weight: bold;
        }
        
        /* 当页面滚动时，改变导航栏的透明度 */
        .scrolled {
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        /* 响应式设计 - 导航栏 */
        @media (max-width: 768px) {
            .navbar ul li {
                margin: 0 8px;
            }
            .navbar ul li a {
                font-size: 0.8rem;
            }
        }
        .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .title { text-align: center; font-size: 18px; font-weight: bold; color: #2d3748; margin-bottom: 25px; padding-bottom: 10px; border-bottom: 1px solid #e2e8f0; }
        
        /* 版本切换 */
        .version-switch { margin-bottom: 20px; text-align: center; }
        .version-btn { padding: 8px 16px; margin: 0 5px; border: 1px solid #4299e1; border-radius: 6px; background: #fff; color: #4299e1; cursor: pointer; }
        .version-btn.active { background: #4299e1; color: #fff; }
        
        /* 基本信息区 */
        .info-area { margin-bottom: 25px; padding: 15px; background: #f7fafc; border-radius: 8px; }
        .info-row { margin: 10px 0; display: flex; flex-wrap: wrap; gap: 10px; }
        .info-label { min-width: 80px; color: #4a5568; }
        .info-input { flex: 1; min-width: 200px; padding: 8px; border: 1px solid #cbd5e0; border-radius: 6px; }
        .required-mark { color: #e53e3e; margin-left: 2px; }
        
        /* 量表问题区 */
        .scale-area { margin-bottom: 25px; }
        .dimension { margin-bottom: 20px; padding: 15px; border-radius: 8px; background: #f7fafc; }
        .dimension-title { font-size: 16px; font-weight: bold; color: #2b6cb0; margin-bottom: 12px; }
        .question { margin: 15px 0; padding-left: 10px; border-left: 3px solid #4299e1; }
        .question-text { margin-bottom: 8px; color: #2d3748; }
        .option-group { display: flex; flex-wrap: wrap; gap: 5px; }
        .option { flex: 1; min-width: 60px; text-align: center; padding: 6px 0; border: 1px solid #cbd5e0; border-radius: 4px; cursor: pointer; }
        .option:hover { background: #edf2f7; }
        .option.selected { background: #4299e1; color: #fff; border-color: #4299e1; }
        .footnote { font-size: 12px; color: #718096; margin-top: 5px; }
        
        /* 结果区 */
        .result-area { display: none; margin: 25px 0; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .result-title { font-size: 16px; font-weight: bold; color: #2d3748; margin-bottom: 15px; text-align: center; }
        .dimension-result { margin: 10px 0; padding: 8px; border-radius: 4px; }
        .risk-low { background: #e6fffa; color: #00796b; }
        .risk-mid { background: #fff8e6; color: #c25100; }
        .risk-high { background: #fed7d7; color: #c53030; }
        .total-result { margin-top: 20px; padding: 12px; background: #edf2f7; border-radius: 6px; font-weight: bold; }
        
        /* 按钮样式 */
        .btn-area { text-align: center; margin: 25px 0; }
        #calculate-btn { padding: 12px 30px; border: none; border-radius: 8px; background: #2b6cb0; color: #fff; font-size: 16px; cursor: pointer; }
        #calculate-btn:hover { background: #2c5282; }
        
        /* 专业提示 */
        .warning { margin-top: 30px; padding: 12px; background: #fff5f5; color: #c53030; border-radius: 8px; font-size: 13px; border: 1px solid #fed7d7; }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar" id="navbar">
        <ul>
               <li><a href="https://hsyscn.top/ ">首页</a></li>  
                <li><a href="https://hsyscn.top/qdhsyscninformation.html ">信息门户</a></li>  
                <li><a href="https://hsyscn.top/team.html ">关于我们</a></li>  
                <li><a href="https://hsyscn.top/pay.html ">支付与捐赠</a></li>  
        </ul>
    </nav>
    <div class="container">
        <div class="title">DSM-5 水平1 症状自评量表 - 成人版</div>

        <!-- 版本切换 -->
        <div class="version-switch">
            <button class="version-btn active" data-version="self">自我报告版</button>
            <button class="version-btn" data-version="informant">知情者报告版</button>
        </div>

        <!-- 基本信息区（标记必填项，除姓名外均为必填） -->
        <div class="info-area" id="self-info">
            <div class="info-row">
                <span class="info-label">姓名：</span>
                <input type="text" class="info-input" id="self-name" placeholder="选填：请输入您的姓名">
            </div>
            <div class="info-row">
                <span class="info-label">年龄：<span class="required-mark">*</span></span>
                <input type="number" class="info-input" id="self-age" placeholder="必填：请输入您的年龄（如：18）">
            </div>
            <div class="info-row">
                <span class="info-label">性别：<span class="required-mark">*</span></span>
                <select class="info-input" id="self-gender">
                    <option value="">必填：请选择</option>
                    <option value="男">男</option>
                    <option value="女">女</option>
                </select>
            </div>
            <div class="info-row">
                <span class="info-label">日期：<span class="required-mark">*</span></span>
                <input type="date" class="info-input" id="self-date">
            </div>
        </div>

        <div class="info-area" id="informant-info" style="display: none;">
            <div class="info-row">
                <span class="info-label">来访者姓名：</span>
                <input type="text" class="info-input" id="informant-name" placeholder="选填：请输入来访者姓名">
            </div>
            <div class="info-row">
                <span class="info-label">与来访者关系：<span class="required-mark">*</span></span>
                <input type="text" class="info-input" id="informant-relation" placeholder="必填：如：家人、朋友、同事">
            </div>
            <div class="info-row">
                <span class="info-label">每周相处时间：<span class="required-mark">*</span></span>
                <input type="number" class="info-input" id="informant-hours" placeholder="必填：请输入小时数（如：10）">
                <span class="info-label">小时/周</span>
            </div>
            <div class="info-row">
                <span class="info-label">评估日期：<span class="required-mark">*</span></span>
                <input type="date" class="info-input" id="informant-date">
            </div>
        </div>

        <!-- 指导语区域 -->
        <div class="instruction-area" id="self-instruction" style="margin-bottom: 25px; padding: 15px; background: #ebf8ff; border-radius: 8px; border-left: 4px solid #3182ce;">
            <div class="instruction-text">指导语: 下面的问题会问一些可能困扰你的事情。对每个问题，选择最能描述你在 <strong>过去2周内</strong> 被这个问题困扰的程度（或频率）的选项。</div>
        </div>
        <div class="instruction-area" id="informant-instruction" style="margin-bottom: 25px; padding: 15px; background: #ebf8ff; border-radius: 8px; border-left: 4px solid #3182ce; display: none;">
            <div class="instruction-text">指导语: 下面的问题会问一些可能困扰来访者的事情。对每个问题，选择最能描述来访者在 <strong>过去2周内</strong> 被这个问题困扰的程度（或频率）的选项。</div>
        </div>

        <!-- 量表问题区（23题，均为必填） -->
        <div class="scale-area">
            <!-- 维度I：抑郁相关 -->
            <div class="dimension">
                <div class="dimension-title">I. 抑郁相关症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="I" data-score="">
                    <div class="question-text self-text">1. 做事情没有兴趣或没有愉悦感？</div>
                    <div class="question-text informant-text" style="display: none;">1. 做事情没有兴趣或没有愉悦感？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="I" data-score="">
                    <div class="question-text self-text">2. 感到低落，抑郁或无望？</div>
                    <div class="question-text informant-text" style="display: none;">2. 感到低落，抑郁或无望？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度II：愤怒相关 -->
            <div class="dimension">
                <div class="dimension-title">II. 愤怒相关症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="II" data-score="">
                    <div class="question-text self-text">3. 比平时更易感到烦躁、不满或愤怒？</div>
                    <div class="question-text informant-text" style="display: none;">3. 比平时更易感到烦躁、不满或愤怒？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度III：躁狂相关 -->
            <div class="dimension">
                <div class="dimension-title">III. 躁狂相关症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="III" data-score="">
                    <div class="question-text self-text">4. 睡眠时间比平时少，但仍然感到精力充沛？</div>
                    <div class="question-text informant-text" style="display: none;">4. 睡眠时间比平时少，但仍然感到精力充沛？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="III" data-score="">
                    <div class="question-text self-text">5. 比平时开始更多的项目，或做更多冒险的事情？</div>
                    <div class="question-text informant-text" style="display: none;">5. 比平时开始更多的项目，或做更多冒险的事情？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度IV：焦虑相关 -->
            <div class="dimension">
                <div class="dimension-title">IV. 焦虑相关症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="IV" data-score="">
                    <div class="question-text self-text">6. 感到紧张、焦虑、害怕、担心或不安？</div>
                    <div class="question-text informant-text" style="display: none;">6. 感到紧张、焦虑、害怕、担心或不安？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="IV" data-score="">
                    <div class="question-text self-text">7. 感到恐慌或恐惧？</div>
                    <div class="question-text informant-text" style="display: none;">7. 感到恐慌或恐惧？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="IV" data-score="">
                    <div class="question-text self-text">8. 回避让你感到焦虑的情境？</div>
                    <div class="question-text informant-text" style="display: none;">8. 回避让来访者感到焦虑的情境？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度V：躯体症状 -->
            <div class="dimension">
                <div class="dimension-title">V. 躯体相关症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="V" data-score="">
                    <div class="question-text self-text">9. 无法解释的疼痛（如头痛、背痛、关节痛、腹痛、腿痛）？</div>
                    <div class="question-text informant-text" style="display: none;">9. 无法解释的疼痛（如头痛、背痛、关节痛、腹痛、腿痛）？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="V" data-score="">
                    <div class="question-text self-text">10. 感觉你的疾病没有被足够重视？</div>
                    <div class="question-text informant-text" style="display: none;">10. 感觉来访者的疾病没有被足够重视？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度VI：自伤风险 -->
            <div class="dimension">
                <div class="dimension-title">VI. 自伤风险 <span class="required-mark">*</span></div>
                <div class="question" data-dim="VI" data-score="">
                    <div class="question-text self-text">11. 有真的想去伤害自己的想法吗？</div>
                    <div class="question-text informant-text" style="display: none;">11. 有真的想去伤害自己的想法吗？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度VII：精神病性症状 -->
            <div class="dimension">
                <div class="dimension-title">VII. 精神病性症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="VII" data-score="">
                    <div class="question-text">12. 听到别人听不到的东西，比如周围没人的时候听到有人说话？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="VII" data-score="">
                    <div class="question-text self-text">13. 感觉有人能够听到你的想法，或者你可以听到别人在想什么？</div>
                    <div class="question-text informant-text" style="display: none;">13. 感觉有人能够听到来访者的想法，或者来访者可以听到别人在想什么？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度VIII：睡眠问题 -->
            <div class="dimension">
                <div class="dimension-title">VIII. 睡眠问题 <span class="required-mark">*</span></div>
                <div class="question" data-dim="VIII" data-score="">
                    <div class="question-text self-text">14. 总的来说，睡眠问题影响了你的睡眠质量？</div>
                    <div class="question-text informant-text" style="display: none;">14. 总的来说，睡眠问题影响了来访者的睡眠质量？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度IX：认知问题 -->
            <div class="dimension">
                <div class="dimension-title">IX. 认知问题 <span class="required-mark">*</span></div>
                <div class="question" data-dim="IX" data-score="">
                    <div class="question-text">15. 记忆问题（如学习新信息）或定位问题（如找到回家的路）？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度X：强迫症状 -->
            <div class="dimension">
                <div class="dimension-title">X. 强迫症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="X" data-score="">
                    <div class="question-text self-text">16. 不愉快的想法、冲动或图像重复地进入你的脑海？</div>
                    <div class="question-text informant-text" style="display: none;">16. 不愉快的想法、冲动或图像重复地进入来访者的脑海？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="X" data-score="">
                    <div class="question-text self-text">17. 感到被驱使着去一遍遍地进行某些行为或者心理活动？</div>
                    <div class="question-text informant-text" style="display: none;">17. 感到被驱使着去一遍遍地进行某些行为或者心理活动？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度XI：解离症状 -->
            <div class="dimension">
                <div class="dimension-title">XI. 解离症状 <span class="required-mark">*</span></div>
                <div class="question" data-dim="XI" data-score="">
                    <div class="question-text self-text">18. 你会感觉与自己、自己的身体、周遭环境、记忆相疏离或有距离吗？</div>
                    <div class="question-text informant-text" style="display: none;">18. 来访者会感觉与自己、自己的身体、周遭环境、记忆相疏离或有距离吗？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度XII：身份认同问题 -->
            <div class="dimension">
                <div class="dimension-title">XII. 身份认同问题 <span class="required-mark">*</span></div>
                <div class="question" data-dim="XII" data-score="">
                    <div class="question-text self-text">19.不知道真实的自己是谁，也不知道自己想从生活中获得什么？</div>
                    <div class="question-text informant-text" style="display: none;">19.不知道真实的来访者是谁，也不知道来访者想从生活中获得什么？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="XII" data-score="">
                    <div class="question-text self-text">20. 感觉跟他人不亲近，或不享受与他人之间的关系？</div>
                    <div class="question-text informant-text" style="display: none;">20. 感觉跟他人不亲近，或不享受与他人之间的关系？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
            </div>

            <!-- 维度XIII：物质使用问题 -->
            <div class="dimension">
                <div class="dimension-title">XIII. 物质使用问题 <span class="required-mark">*</span></div>
                <div class="question" data-dim="XIII" data-score="">
                    <div class="question-text self-text">21. 在一天之内至少4次饮用任何种类的酒精饮料？</div>
                    <div class="question-text informant-text" style="display: none;">21. 在一天之内至少4次饮用任何种类的酒精饮料？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="XIII" data-score="">
                    <div class="question-text self-text">22. 吸任何香烟、雪茄、烟斗或使用鼻烟或咀嚼烟草？</div>
                    <div class="question-text informant-text" style="display: none;">22. 吸任何香烟、雪茄、烟斗或使用鼻烟或咀嚼烟草？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                </div>
                <div class="question" data-dim="XIII" data-score="">
                    <div class="question-text self-text">23. 私自使用 任何下列药物，也就是说，没有医生处方，使用更多的剂量或比处方更长的使用期【止痛药（如维柯丁），兴奋剂（如利他林或阿德拉）、镇静剂或镇定剂（如安眠药或安定）、或毒品如大麻、可卡因或强效纯可卡因，夜店毒品（如摇头丸），迷幻剂（如LSD），海洛因，吸入剂或溶剂（如强力胶），或者甲基苯丙胺（如快速丸）】？</div>
                    <div class="question-text informant-text" style="display: none;">23. 私自使用 任何下列药物，也就是说，没有医生处方，使用更多的剂量或比处方更长的使用期【止痛药（如维柯丁），兴奋剂（如利他林或阿德拉）、镇静剂或镇定剂（如安眠药或安定）、或毒品如大麻、可卡因或强效纯可卡因，夜店毒品（如摇头丸），迷幻剂（如LSD），海洛因，吸入剂或溶剂（如强力胶），或者甲基苯丙胺（如快速丸）】？</div>
                    <div class="option-group">
                        <div class="option" data-value="0">无</div>
                        <div class="option" data-value="1">轻微</div>
                        <div class="option" data-value="2">轻度</div>
                        <div class="option" data-value="3">中度</div>
                        <div class="option" data-value="4">重度</div>
                    </div>
                    <div class="footnote">注：强力胶是一种毒品，非生活中常见的固体或液体胶。</div>
                </div>
            </div>
        </div>

        <!-- 计算按钮 -->
        <div class="btn-area">
            <button id="calculate-btn">生成评估结果</button>
        </div>

        <!-- 结果区 -->
        <div class="result-area" id="result-area">
            <div class="result-title">DSM-5 水平1 症状自评量表结果</div>
            <div id="basic-info-display"></div> <!-- 基本信息展示 -->
            <div id="dimension-results"></div> <!-- 各维度结果 -->
            <div class="total-result" id="total-result"></div> <!-- 综合建议 -->
        </div>

        <!-- 专业提示 -->
        <div class="warning">
            ⚠️ 重要提示：1. 这些结果仅作为DSM-5 水平1症状筛查的初步参考，<strong>不能替代精神科医生/临床心理师的专业诊断</strong>；2. 若自伤风险（维度VI）得分≥2分，或存在明显的精神病性症状（维度VII），请立即联系精神卫生医疗机构或危机干预热线；3. 非专业人员禁止使用此量表对他人进行评估。
        </div>
        <a href="http://s01.flagcounter.com/more/JW1"><img src="https://s01.flagcounter.com/map/JW1/size_s/txt_000000/border_CCCCCC/pageviews_0/viewers_0/flags_0/" alt="访问统计" border="0"></a>
        <a href="https://hsyscn.top/">返回首页</a>
    </div>

    <script>
        // 1. 版本切换功能
        const versionBtns = document.querySelectorAll('.version-btn');
        const selfInfo = document.getElementById('self-info');
        const informantInfo = document.getElementById('informant-info');
        const selfInstruction = document.getElementById('self-instruction');
        const informantInstruction = document.getElementById('informant-instruction');
        const selfTexts = document.querySelectorAll('.self-text');
        const informantTexts = document.querySelectorAll('.informant-text');
        let currentVersion = 'self'; // 默认自我报告版

        versionBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // 切换按钮状态
                versionBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                // 切换信息区和指导语
                currentVersion = btn.dataset.version;
                if (currentVersion === 'self') {
                    selfInfo.style.display = 'block';
                    informantInfo.style.display = 'none';
                    selfInstruction.style.display = 'block';
                    informantInstruction.style.display = 'none';
                    // 显示自我报告版问题文本，隐藏知情者版
                    selfTexts.forEach(text => text.style.display = 'block');
                    informantTexts.forEach(text => text.style.display = 'none');
                } else {
                    selfInfo.style.display = 'none';
                    informantInfo.style.display = 'block';
                    selfInstruction.style.display = 'none';
                    informantInstruction.style.display = 'block';
                    // 显示知情者版问题文本，隐藏自我报告版
                    selfTexts.forEach(text => text.style.display = 'none');
                    informantTexts.forEach(text => text.style.display = 'block');
                }
                // 隐藏结果区
                document.getElementById('result-area').style.display = 'none';
            });
        });

        // 2. 选项选择与得分绑定
        const questions = document.querySelectorAll('.question');
        questions.forEach(question => {
            const options = question.querySelectorAll('.option');
            options.forEach(option => {
                option.addEventListener('click', () => {
                    // 清除当前问题的其他选项选中状态
                    options.forEach(opt => opt.classList.remove('selected'));
                    // 选中当前选项
                    option.classList.add('selected');
                    // 记录得分（非空）
                    question.dataset.score = option.dataset.value;
                });
            });
        });

        // 3. 新增：严格鉴权函数（检查必填项）
        function checkRequiredFields() {
            const missingFields = [];

            // 检查基本信息（除姓名外均必填）
            if (currentVersion === 'self') {
                const age = document.getElementById('self-age').value.trim();
                const gender = document.getElementById('self-gender').value;
                const date = document.getElementById('self-date').value;

                if (!age) missingFields.push('年龄（自我报告版）');
                if (!gender) missingFields.push('性别（自我报告版）');
                if (!date) missingFields.push('评估日期（自我报告版）');
                // 保留中文提示信息不变
            } else {
                const relation = document.getElementById('informant-relation').value.trim();
                const hours = document.getElementById('informant-hours').value.trim();
                const date = document.getElementById('informant-date').value;

                if (!relation) missingFields.push('与来访者关系（知情者版）');
                if (!hours) missingFields.push('每周相处时间（知情者版）');
                if (!date) missingFields.push('评估日期（知情者版）');
            }

            // 检查所有23题是否都已作答（data-score不能为空）
            questions.forEach((question, index) => {
                if (!question.dataset.score) {
                    missingFields.push(`第${index + 1}题（症状题）`);
                }
            });

            // 返回漏填项（空数组即无漏填）
            return missingFields;
        }

        // 4. 结果计算与提交（含鉴权）
        const calculateBtn = document.getElementById('calculate-btn');
        calculateBtn.addEventListener('click', () => {
            // 第一步：执行鉴权，检查必填项
            const missing = checkRequiredFields();
            if (missing.length > 0) {
                // 提示必填项未完成，阻止提交
                alert(`请在提交前完成以下必填字段：\n\n${missing.join('\n')}`);
                return; // 终止后续流程
            }

            // 第二步：鉴权通过，获取基本信息
            let basicInfoHtml = '';
            if (currentVersion === 'self') {
                const name = document.getElementById('self-name').value.trim() || '未填写';
                const age = document.getElementById('self-age').value.trim();
                const gender = document.getElementById('self-gender').value;
                const date = document.getElementById('self-date').value;

                basicInfoHtml = `
                    <div class="info-row"><strong>评估对象：</strong>${name}</div>
                    <div class="info-row"><strong>年龄：</strong>${age} 岁</div>
                    <div class="info-row"><strong>性别：</strong>${gender}</div>
                    <div class="info-row"><strong>评估日期：</strong>${date}</div>
                `;
            } else {
                const name = document.getElementById('informant-name').value.trim() || '未填写';
                const relation = document.getElementById('informant-relation').value.trim();
                const hours = document.getElementById('informant-hours').value.trim();
                const date = document.getElementById('informant-date').value;

                basicInfoHtml = `
                    <div class="info-row"><strong>来访者姓名：</strong>${name}</div>
                    <div class="info-row"><strong>与来访者关系：</strong>${relation}</div>
                    <div class="info-row"><strong>每周相处时间：</strong>${hours} 小时</div>
                    <div class="info-row"><strong>评估日期：</strong>${date}</div>
                `;
            }

            // 第三步：按维度统计得分
            const dimScores = {
                'I': 0, 'II': 0, 'III': 0, 'IV': 0, 'V': 0,
                'VI': 0, 'VII': 0, 'VIII': 0, 'IX': 0, 'X': 0,
                'XI': 0, 'XII': 0, 'XIII': 0
            };
            const dimNames = {
                'I': '抑郁相关症状', 'II': '愤怒相关症状', 'III': '躁狂相关症状',
                'IV': '焦虑相关症状', 'V': '躯体相关症状', 'VI': '自伤风险',
                'VII': '精神病性症状', 'VIII': '睡眠问题', 'IX': '认知问题',
                'X': '强迫症状', 'XI': '解离症状', 'XII': '身份认同问题',
                'XIII': '物质使用问题'
            };

            questions.forEach(question => {
                const dim = question.dataset.dim;
                dimScores[dim] += parseInt(question.dataset.score);
            });

            // 第四步：生成各维度结果
            let dimensionResultsHtml = '';
            let highRiskDims = [];
            Object.keys(dimScores).forEach(dim => {
                const score = dimScores[dim];
                const name = dimNames[dim];
                let riskClass = 'risk-low';
                let riskText = '低风险';
                let suggestion = '无明显症状困扰，建议保持当前积极状态，定期进行自我觉察。';

                // 特殊维度：自伤风险（VI）
                if (dim === 'VI') {
                    if (score >= 2) {
                        riskClass = 'risk-high';
                        riskText = '高风险';
                        suggestion = '存在明显自伤意念，需要立即寻求专业心理健康或危机干预帮助！';
                        highRiskDims.push(name);
                    } else {
                        riskClass = 'risk-low';
                        riskText = '低风险';
                        suggestion = '无明显自伤意念，建议继续关注情绪状态。';
                    }
                } 
                // 其他维度
                else {
                    if (score >= 7) {
                        riskClass = 'risk-high';
                        riskText = '高风险';
                        suggestion = '症状明显且持续，显著影响生活，建议尽快寻求精神科医疗帮助。';
                        highRiskDims.push(name);
                    } else if (score >= 3) {
                        riskClass = 'risk-mid';
                        riskText = '中风险';
                        suggestion = '存在一定症状困扰，建议寻求心理咨询帮助，必要时转诊精神科。';
                    }
                }

                dimensionResultsHtml += `
                    <div class="dimension-result ${riskClass}">
                        <strong>${dim}. ${name}</strong>：得分 ${score} 分 (${riskText})
                        <br>建议：${suggestion}
                    </div>
                `;
            });

            // 第五步：生成综合建议
            let totalSuggestion = '';
            if (highRiskDims.length > 0) {
                totalSuggestion = `综合评估：存在高风险维度（${highRiskDims.join('、')}），情况紧急，<strong>请立即联系精神科医生或专业危机干预机构</strong>，避免延误干预时机。`;
            } else if (Object.values(dimScores).some(score => score >= 3)) {
                totalSuggestion = '综合评估：存在中风险症状维度，建议在1个月内完成专业心理咨询或精神科筛查，明确症状性质并制定干预计划。';
            } else {
                totalSuggestion = '综合评估：所有维度均为低风险，无明显临床症状困扰，建议每3个月进行一次自我筛查，保持健康的生活方式（规律作息、适量运动、良好社交）。';
            }

            // 第五步：识别中风险维度
            let midRiskDims = [];
            Object.keys(dimScores).forEach(dim => {
                const score = dimScores[dim];
                const name = dimNames[dim];
                
                if (dim === 'VI' && score < 2) {
                    // 自伤风险维度不设中风险
                } else if (score >= 3 && score < 7) {
                    midRiskDims.push(name);
                }
            });
            
            // 第六步：根据高风险和中风险维度生成推荐量表
            let recommendedScales = [];
            if (highRiskDims.includes('自伤风险') || dimScores.VI >= 2) {
                recommendedScales.push('哥伦比亚自杀严重程度评定量表(C-SSRS)');
            }
            if (highRiskDims.includes('抑郁相关症状') || midRiskDims.includes('抑郁相关症状')) {
                recommendedScales.push('患者健康问卷-9项(PHQ-9)');
            }
            if (highRiskDims.includes('焦虑相关症状') || midRiskDims.includes('焦虑相关症状')) {
                recommendedScales.push('广泛性焦虑障碍量表-7项(GAD-7)');
            }
            if (highRiskDims.includes('精神病性症状') || midRiskDims.includes('精神病性症状')) {
                recommendedScales.push('简明精神病评定量表(BPRS)');
            }
            if (highRiskDims.includes('物质使用问题') || midRiskDims.includes('物质使用问题')) {
                recommendedScales.push('酒精使用障碍识别测试(AUDIT)');
            }
            if (highRiskDims.includes('强迫症状') || midRiskDims.includes('强迫症状')) {
                recommendedScales.push('耶鲁-布朗强迫量表(Y-BOCS)');
            }
            
            // 第七步：填充并显示结果
            document.getElementById('basic-info-display').innerHTML = basicInfoHtml;
            document.getElementById('dimension-results').innerHTML = dimensionResultsHtml;
            document.getElementById('total-result').innerHTML = totalSuggestion;
            
            // 确保结果区域可见
            const resultArea = document.getElementById('result-area');
            resultArea.style.display = 'block';
            resultArea.scrollIntoView({ behavior: 'smooth' });
            
            // 生成用于AI分析的文本，但不在界面显示，仅提供复制功能
            // 基本信息对象
            const basicInfo = {
                age: currentVersion === 'self' ? document.getElementById('self-age').value.trim() : 
                    document.getElementById('informant-age').value.trim(),
                gender: currentVersion === 'self' ? document.getElementById('self-gender').value : 
                    document.getElementById('informant-gender').value
            };
            
            // 计算总分
            let totalScore = 0;
            for (let dim in dimScores) {
                totalScore += dimScores[dim];
            }
            
            // 获取基本信息
            const ageGenderText = currentVersion === 'self' ? 
                `${basicInfo.age}岁${basicInfo.gender}性测试者` : 
                `评估对象为${basicInfo.age}岁${basicInfo.gender}性来访者`;
            
            // 获取量表名称
            const scaleName = 'DSM-5 水平1 症状自评量表';
            
            // 获取每题选择与题干
            let questionsDetails = '\n\n每题具体选择与题干：\n';
            const questionElements = document.querySelectorAll('.question');
            questionElements.forEach((questionEl, index) => {
                // 获取当前版本的问题文本（添加防御性编程）
            const textElement = currentVersion === 'self' ? 
                questionEl.querySelector('.self-text') : 
                questionEl.querySelector('.informant-text');
            const questionText = textElement ? textElement.innerText : '未获取到问题文本';
                
                // 获取选中的选项文本（添加防御性编程）
                let selectedOptionText = '未选择';
                const selectedOptionEl = questionEl.querySelector('.option.selected');
                
                if (selectedOptionEl) {
                    selectedOptionText = selectedOptionEl.innerText;
                } else if (questionEl.dataset.score) {
                    // 如果没有找到.selected类，但有data-score，通过得分值查找选项
                    const scoreValue = questionEl.dataset.score;
                    const optionWithScore = questionEl.querySelector(`.option[data-value="${scoreValue}"]`);
                    if (optionWithScore) {
                        selectedOptionText = optionWithScore.innerText;
                    }
                }
                
                questionsDetails += `${index + 1}. ${questionText} - 选择：${selectedOptionText}\n`;
            });
            
            // 生成符合用户要求的输出文本
            let aiAnalysisText = `我是一名${ageGenderText}，测了${scaleName}，总得分为${totalScore}分。${questionsDetails}\n请你为我分析，并给我推荐下一步建设性的操作指示或下一步应选择的量表。如果必要，请详细与我进行交谈来获取更多信息或其他操作`;
            
            // 移除推荐量表，改为将问题抛给用户
            aiAnalysisText += '\n\n请问您需要我为您提供哪方面的分析或建议？您可以告诉我您最关心的问题。';
            
            // 添加一个隐藏的容器用于存储AI分析文本
            const hiddenContainer = document.createElement('div');
            hiddenContainer.id = 'ai-analysis-content';
            hiddenContainer.style.display = 'none';
            hiddenContainer.innerText = aiAnalysisText;
            document.body.appendChild(hiddenContainer);
            
            // 检查是否已存在复制按钮，如果有则移除
            const existingCopyButton = document.getElementById('copy-ai-analysis');
            if (existingCopyButton) {
                existingCopyButton.remove();
            }
            
            // 在结果区域底部添加一个明显的复制按钮
            const copyButtonWrapper = document.createElement('div');
            copyButtonWrapper.style.textAlign = 'center';
            copyButtonWrapper.style.marginTop = '30px';
            copyButtonWrapper.style.marginBottom = '20px';
            
            const copyButton = document.createElement('button');
            copyButton.id = 'copy-ai-analysis';
            copyButton.style.padding = '12px 24px';
            copyButton.style.border = 'none';
            copyButton.style.borderRadius = '6px';
            copyButton.style.background = '#4299e1';
            copyButton.style.color = '#fff';
            copyButton.style.cursor = 'pointer';
            copyButton.style.fontSize = '16px';
            copyButton.style.fontWeight = 'bold';
            copyButton.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
            copyButton.style.transition = 'background-color 0.3s ease';
            copyButton.innerText = '复制评估结果用于AI分析';
            
            // 添加悬停效果
            copyButton.addEventListener('mouseover', function() {
                copyButton.style.background = '#3182ce';
            });
            
            copyButton.addEventListener('mouseout', function() {
                copyButton.style.background = '#4299e1';
            });
            
            // 添加复制按钮事件监听
            copyButton.addEventListener('click', function() {
                const textToCopy = document.getElementById('ai-analysis-content').innerText;
                navigator.clipboard.writeText(textToCopy).then(function() {
                    alert('评估结果已复制到剪贴板！');
                }, function(err) {
                    alert('复制失败：' + err);
                });
            });
            
            copyButtonWrapper.appendChild(copyButton);
            resultArea.appendChild(copyButtonWrapper);
            
            // 评估数据处理完成

        });
    </script>
    
    <!-- 导航栏滚动效果脚本 -->
    <script>
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });
    </script>
</body>
</html>
